<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Media Kit</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/media_kit_edit.css' %}">
</head>
<body>
    <div class="media-kit-container">
        <div class="nav-links">
            <a href="#">Campaigns</a>
            <a href="#">FAQ</a>
            <a href="#">Contact</a>
        </div>

        <form method="post" enctype="multipart/form-data">
               {% csrf_token %}

               <section class="card">
                   <div class="card-header">
                       <h2>Edit Media Kit Information</h2>
                   </div>
                   <div class="card-content grid-two-columns">
                       <div class="profile-edit">
                           <div class="form-group">
                               <label for="{{ media_kit_form.profile_photo.id_for_label }}">Profile Photo</label>
                               {{ media_kit_form.profile_photo }}
                           </div>
                           <div class="form-group">
                               <label for="{{ media_kit_form.banner_image.id_for_label }}">Banner Image</label>
                               {{ media_kit_form.banner_image }}
                           </div>
                       </div>
                       <div class="profile-details">
                           <div class="form-group">
                               <label for="{{ media_kit_form.name.id_for_label }}">Name</label>
                               {{ media_kit_form.name }}
                           </div>
                           <div class="form-group">
                               <label for="{{ media_kit_form.username.id_for_label }}">Username</label>
                               {{ media_kit_form.username }}
                           </div>
                           <div class="form-group">
                               <label for="{{ media_kit_form.location.id_for_label }}">Location</label>
                               {{ media_kit_form.location }}
                           </div>
                           <div class="form-group">
                               <label for="{{ media_kit_form.bio.id_for_label }}">Bio</label>
                               {{ media_kit_form.bio }}
                           </div>
                           <div class="form-group">
                               <label>Tags</label>
                               {{ media_kit_form.tags }}
                           </div>
                       </div>
                   </div>
               </section>

               <section class="card">
                   <div class="card-header">
                       <h2>Social Platforms</h2>
                   </div>
                   <div class="card-content">
                       {{ social_platform_formset.management_form }}
                       {% for form in social_platform_formset %}
                           <div class="form-row social-platform-row">
                               <div class="form-group">
                                   <label>Platform</label>
                                   {{ form.platform }}
                               </div>
                               <div class="form-group">
                                   <label>Followers</label>
                                   {{ form.followers }}
                               </div>
                               <div class="form-group">
                                   <label>Engagement Rate</label>
                                   {{ form.engagement_rate }}
                               </div>
                               <div class="form-group">
                                   <label>Average Views</label>
                                   {{ form.average_views }}
                               </div>
                           </div>
                       {% endfor %}
                   </div>
               </section>

            <section class="card">
                <div class="card-header">
                    <h2>Work With Me</h2>
                </div>
                <div class="card-content" id="work-with-me-container">
                    {{ work_with_me_formset.management_form }}
                    {% for form in work_with_me_formset %}
                        <div class="form-row work-with-me-row" data-row-id="{{ forloop.counter }}">
                            <div class="form-group">
                                <label>Platform</label>
                                {{ form.platform }}
                            </div>
                            <div class="form-group">
                                <label>Offering</label>
                                {{ form.offering }}
                            </div>
                            <div class="form-group">
                                <label>Service Description</label>
                                {{ form.service_description }}
                            </div>
                            <div class="form-group">
                                <label>Price</label>
                                {{ form.price }}
                            </div>
                            <div class="form-group">
                                <label>CTA Button</label>
                                {{ form.cta_button }}
                            </div>
                            <button type="button" class="delete-offering-button" data-row-id="{{ forloop.counter }}">Delete</button>
                        </div>
                    {% endfor %}
                </div>
                <button type="button" id="add-offering-button" class="add-button">Add New Offering</button>
            </section>


               <section class="card">
                   <div class="card-header">
                       <h2>Gallery</h2>
                   </div>
                   <div class="card-content">
                       {{ gallery_formset.management_form }}
                       {% for form in gallery_formset %}
                           <div class="form-row gallery-row">
                               <div class="form-group">
                                   <label>Platform</label>
                                   {{ form.platform }}
                               </div>
                               <div class="form-group">
                                   <label>Content URL</label>
                                   {{ form.url }}
                               </div>
                           </div>
                       {% endfor %}
                   </div>
               </section>

               <div class="form-actions">
                   <button type="submit" class="save-button">Save Media Kit</button>
               </div>
           </form>

           <footer>
               Â© {% now "Y" %} Word on the Block. All rights reserved.
           </footer>
       </div>

       <script>
       	document.getElementById('add-offering-button').addEventListener('click', function () {
       	    const container = document.getElementById('work-with-me-container');
       	    const newRow = document.createElement('div');
       	    newRow.classList.add('form-row', 'work-with-me-row');
       	    newRow.innerHTML = `
       	        <div class="form-group">
       	            <label>Platform</label>
       	            <input type="text" name="new_platform" class="form-control">
       	        </div>
       	        <div class="form-group">
       	            <label>Offering</label>
       	            <input type="text" name="new_offering" class="form-control">
       	        </div>
       	        <div class="form-group">
       	            <label>Service Description</label>
       	            <textarea name="new_service_description" class="form-control"></textarea>
       	        </div>
       	        <div class="form-group">
       	            <label>Price</label>
       	            <input type="text" name="new_price" class="form-control">
       	        </div>
       	        <div class="form-group">
       	            <label>CTA Button</label>
       	            <input type="text" name="new_cta_button" class="form-control">
       	        </div>
       	    `;
       	    container.appendChild(newRow);
       	});

       </script>
       <script type="text/javascript">
       	document.addEventListener('DOMContentLoaded', function () {
       	    const container = document.getElementById('work-with-me-container');

       	    // Event delegation for delete buttons
       	    container.addEventListener('click', function (e) {
       	        if (e.target.classList.contains('delete-offering-button')) {
       	            const rowId = e.target.getAttribute('data-row-id');
       	            const row = document.querySelector(`[data-row-id="${rowId}"]`);

       	            if (row) {
       	                // Add a hidden input to mark the item for deletion
       	                const deleteInput = document.createElement('input');
       	                deleteInput.type = 'hidden';
       	                deleteInput.name = `work_with_me_formset-${rowId}-DELETE`;
       	                deleteInput.value = 'on';
       	                container.appendChild(deleteInput);

       	                // Remove the row from the DOM
       	                row.remove();
       	            }
       	        }
       	    });
       	});

       </script>
</html>